<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>API Documentation &#8212; Topyfic 0.0.11 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/bootstrap-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="_static/graphviz.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Citation" href="cite.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="_static/js/jquery-1.12.4.min.js"></script>
<script type="text/javascript" src="_static/js/jquery-fix.js"></script>
<script type="text/javascript" src="_static/bootstrap-3.4.1/js/bootstrap.min.js"></script>
<script type="text/javascript" src="_static/bootstrap-sphinx.js"></script>

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="index.html">
          Topyfic</a>
        <span class="navbar-text navbar-version pull-left"><b></b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="cite.html">Citation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">API Documentation</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">API Documentation</a></li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="cite.html" title="Previous Chapter: Citation"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Citation</span>
    </a>
  </li>
              
            
            
            
            
              <li class="hidden-sm">
<div id="sourcelink">
  <a href="_sources/api.rst.txt"
     rel="nofollow">Source</a>
</div></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <div class="section" id="module-Topyfic.train">
<span id="api-documentation"></span><h1>API Documentation<a class="headerlink" href="#module-Topyfic.train" title="Permalink to this heading">¶</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="Topyfic.train.Train">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">Topyfic.train.</span></span><span class="sig-name descname"><span class="pre">Train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_runs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Topyfic/train.html#Train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Topyfic.train.Train" title="Permalink to this definition">¶</a></dt>
<dd><p>A class used to train reproducible latent dirichlet allocation (rLDA) model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>str</em>) – name of the Train class</p></li>
<li><p><strong>k</strong> (<em>int</em>) – number of topics to learn one LDA model using sklearn package</p></li>
<li><p><strong>n_runs</strong> (<em>int</em>) – number of run to define rLDA model (default: 100)</p></li>
<li><p><strong>random_state_range</strong> (<em>list of int</em>) – list of random state, we used to run LDA models (default: range(n_runs))</p></li>
<li><p><strong>top_models</strong> (<em>list of TopModel</em>) – list of TopModel class to save all LDA models</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="Topyfic.train.Train.combine_LDA_models">
<span class="sig-name descname"><span class="pre">combine_LDA_models</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">single_trains</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Topyfic/train.html#Train.combine_LDA_models"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Topyfic.train.Train.combine_LDA_models" title="Permalink to this definition">¶</a></dt>
<dd><p>combine single top_model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>anndata</em>) – data you used to learn model</p></li>
<li><p><strong>single_trains</strong> (<em>list</em>) – list of single train object</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Topyfic.train.Train.make_LDA_models_attributes">
<span class="sig-name descname"><span class="pre">make_LDA_models_attributes</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/Topyfic/train.html#Train.make_LDA_models_attributes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Topyfic.train.Train.make_LDA_models_attributes" title="Permalink to this definition">¶</a></dt>
<dd><p>make LDA attributes by combining all single LDA model attributes which you need to define LDA model (sklearn.decomposition.LatentDirichletAllocation)</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>three data frame which the first one is gathering all components from all LDA runs,</p>
</dd>
</dl>
<p>the second one is exp_dirichlet_component from all LDA runs and
the last one is combining the rest of LDA attributes which put them to gather as a dataframe
:rtype: pandas dataframe, pandas dataframe, pandas dataframe</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Topyfic.train.Train.make_single_LDA_model">
<span class="sig-name descname"><span class="pre">make_single_LDA_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">learning_method</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Topyfic/train.html#Train.make_single_LDA_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Topyfic.train.Train.make_single_LDA_model" title="Permalink to this definition">¶</a></dt>
<dd><p>train simple LDA model using sklearn package and embed it to TopModel class</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>str</em>) – name of LDA model</p></li>
<li><p><strong>data</strong> (<em>anndata</em>) – processed expression data along with cells and genes/region information</p></li>
<li><p><strong>random_state</strong> (<em>int</em>) – Pass an int for reproducible results across multiple function calls</p></li>
<li><p><strong>max_iter</strong> (<em>int</em>) – The maximum number of passes over the training data (aka epochs) (default = 10)</p></li>
<li><p><strong>batch_size</strong> (<em>int</em>) – Number of documents to use in each EM iteration. Only used in online learning. (default = 1000)</p></li>
<li><p><strong>learning_method</strong> (<em>str</em>) – Method used to update _component. {‘batch’, ‘online’} (default=’online’)</p></li>
<li><p><strong>n_jobs</strong> (<em>int</em>) – The number of jobs to use in the E-step. None means 1 unless in a <a class="reference external" href="https://joblib.readthedocs.io/en/latest/parallel.html#joblib.parallel_backend">joblib.parallel_backend</a> context. -1 means using all processors.  See <a class="reference external" href="https://scikit-learn.org/stable/glossary.html#term-n_jobs">Glossary</a> for more details. (default = None)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>LDA model embedded in TopModel class</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#Topyfic.topModel.TopModel" title="Topyfic.topModel.TopModel">TopModel</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Topyfic.train.Train.run_LDA_models">
<span class="sig-name descname"><span class="pre">run_LDA_models</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">learning_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'online'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_thread</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Topyfic/train.html#Train.run_LDA_models"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Topyfic.train.Train.run_LDA_models" title="Permalink to this definition">¶</a></dt>
<dd><p>train LDA models</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>max_iter</strong> (<em>int</em>) – The maximum number of passes over the training data (aka epochs) (default = 10)</p></li>
<li><p><strong>batch_size</strong> (<em>int</em>) – Number of documents to use in each EM iteration. Only used in online learning. (default = 1000)</p></li>
<li><p><strong>learning_method</strong> (<em>str</em>) – Method used to update _component. {‘batch’, ‘online’} (default=’online’)</p></li>
<li><p><strong>data</strong> (<em>anndata</em>) – expression data embedded in anndata format use to train LDA model</p></li>
<li><p><strong>n_jobs</strong> (<em>int</em>) – <p>The number of jobs to use in the E-step. None means 1 unless in a <a class="reference external" href="https://joblib.readthedocs.io/en/latest/parallel.html#joblib.parallel_backend">joblib.parallel_backend</a> context. -1 means using all processors.  See <a class="reference external" href="https://scikit-learn.org/stable/glossary.html#term-n_jobs">Glossary</a> for more details. (default = None)</p>
</p></li>
<li><p><strong>n_thread</strong> (<em>int</em>) – number of threads you used to learn LDA models (default=1)</p></li>
<li><p><strong>**kwargs</strong> – <p>other parameter in sklearn.decomposition.LatentDirichletAllocation function (more info: <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.decomposition.LatentDirichletAllocation.html">https://scikit-learn.org/stable/modules/generated/sklearn.decomposition.LatentDirichletAllocation.html</a>)</p>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Topyfic.train.Train.save_train">
<span class="sig-name descname"><span class="pre">save_train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Topyfic/train.html#Train.save_train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Topyfic.train.Train.save_train" title="Permalink to this definition">¶</a></dt>
<dd><p>save Train class as a pickle file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>str</em>) – name of the pickle file (default is train_Train.name)</p></li>
<li><p><strong>save_path</strong> (<em>str</em>) – directory you want to use to save pickle file (default is saving near script)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<span class="target" id="module-Topyfic.topic"></span><dl class="py class">
<dt class="sig sig-object py" id="Topyfic.topic.Topic">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">Topyfic.topic.</span></span><span class="sig-name descname"><span class="pre">Topic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">topic_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">topic_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">topic_gene_weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gene_information</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">topic_information</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Topyfic/topic.html#Topic"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Topyfic.topic.Topic" title="Permalink to this definition">¶</a></dt>
<dd><p>A class saved topic along with other useful information</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>topic_id</strong> (<em>str</em>) – ID of topic which is unique</p></li>
<li><p><strong>topic_name</strong> (<em>str</em>) – name of the topic (default: topic_id)</p></li>
<li><p><strong>topic_gene_weights</strong> (<em>pandas dataframe</em>) – dataframe that contains weights of the topics for each genes</p></li>
<li><p><strong>gene_information</strong> (<em>pandas dataframe</em>) – dataframe that contains information of genes i.e gene biotype</p></li>
<li><p><strong>topic_information</strong> (<em>pandas dataframe</em>) – dataframe that contains information of genes i.e cell state / cell type</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="Topyfic.topic.Topic.GSEA">
<span class="sig-name descname"><span class="pre">GSEA</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gene_sets</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'GO_Biological_Process_2021'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pdf'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'GSEA'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Topyfic/topic.html#Topic.GSEA"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Topyfic.topic.Topic.GSEA" title="Permalink to this definition">¶</a></dt>
<dd><p>Doing Gene Set Enrichment Analysis on based on the topic weights using GSEAPY package.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gene_sets</strong> (<em>str</em><em>, </em><em>list</em><em>, </em><em>tuple</em>) – Enrichr Library name or .gmt gene sets file or dict of gene sets. (you can add any Enrichr Libraries from here: <a class="reference external" href="https://maayanlab.cloud/Enrichr/#stats">https://maayanlab.cloud/Enrichr/#stats</a>)</p></li>
<li><p><strong>p_value</strong> (<em>float</em>) – Defines the pValue threshold for plotting. (default: 0.05)</p></li>
<li><p><strong>table</strong> (<em>bool</em>) – indicate if you want to save all GO terms that passed the threshold as a table (default: True)</p></li>
<li><p><strong>plot</strong> (<em>bool</em>) – indicate if you want to plot all GO terms that passed the threshold (default: True)</p></li>
<li><p><strong>file_format</strong> (<em>str</em>) – indicate the format of plot (default: pdf)</p></li>
<li><p><strong>file_name</strong> (<em>str</em>) – name and path of the plot use for save (default: gene_composition)</p></li>
<li><p><strong>kwargs</strong> – Argument to pass to gseapy.prerank(). more info: <a class="reference external" href="https://gseapy.readthedocs.io/en/latest/run.html?highlight=gp.prerank#gseapy.prerank">https://gseapy.readthedocs.io/en/latest/run.html?highlight=gp.prerank#gseapy.prerank</a></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>dataframe contains these columns: Term: gene set name, ES: enrichment score, NES: normalized enrichment score, NOM p-val:  Nominal p-value (from the null distribution of the gene set, FDR q-val: FDR qvalue (adjusted False Discory Rate), FWER p-val: Family wise error rate p-values, Tag %: Percent of gene set before running enrichment peak (ES), Gene %: Percent of gene list before running enrichment peak (ES), Lead_genes: leading edge genes (gene hits before running enrichment peak)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pandas dataframe</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Topyfic.topic.Topic.functional_enrichment_analysis">
<span class="sig-name descname"><span class="pre">functional_enrichment_analysis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">organism</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sets</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pdf'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'functional_enrichment_analysis'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Topyfic/topic.html#Topic.functional_enrichment_analysis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Topyfic.topic.Topic.functional_enrichment_analysis" title="Permalink to this definition">¶</a></dt>
<dd><p>Doing functional enrichment analysis including GO, KEGG and REACTOME</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>type</strong> (<em>str</em>) – indicate the type of databases which it should be one of “GO”, “REACTOME”</p></li>
<li><p><strong>organism</strong> (<em>str</em>) – name of the organ you want to do functional enrichment analysis</p></li>
<li><p><strong>sets</strong> (<em>str</em><em>, </em><em>list</em><em>, </em><em>tuple</em>) – str, list, tuple of Enrichr Library name(s). (you can add any Enrichr Libraries from here: <a class="reference external" href="https://maayanlab.cloud/Enrichr/#stats">https://maayanlab.cloud/Enrichr/#stats</a>) only need to fill if the type is GO</p></li>
<li><p><strong>p_value</strong> (<em>float</em>) – Defines the pValue threshold. (default: 0.05)</p></li>
<li><p><strong>file_format</strong> (<em>str</em>) – indicate the format of plot (default: pdf)</p></li>
<li><p><strong>file_name</strong> (<em>str</em>) – name and path of the plot use for save (default: gene_composition)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Topyfic.topic.Topic.gene_weight_variance">
<span class="sig-name descname"><span class="pre">gene_weight_variance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Topyfic/topic.html#Topic.gene_weight_variance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Topyfic.topic.Topic.gene_weight_variance" title="Permalink to this definition">¶</a></dt>
<dd><p>calculate the gene weight variance</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>save</strong> (<em>bool</em>) – added as an information to the Topic (default: True)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Gene weight variance for given topic</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Topyfic.topic.Topic.update_gene_information">
<span class="sig-name descname"><span class="pre">update_gene_information</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gene_information</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Topyfic/topic.html#Topic.update_gene_information"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Topyfic.topic.Topic.update_gene_information" title="Permalink to this definition">¶</a></dt>
<dd><p>update/add genes information for each topics</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>gene_information</strong> (<em>pandas dataframe</em>) – dataframe contains genes information we would like to add/update (the index should be same as an index of gene_information in class)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Topyfic.topic.Topic.write_topic_yaml">
<span class="sig-name descname"><span class="pre">write_topic_yaml</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">topic_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_yaml_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'model.yaml'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">topic_yaml_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'topic.yaml'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Topyfic/topic.html#Topic.write_topic_yaml"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Topyfic.topic.Topic.write_topic_yaml" title="Permalink to this definition">¶</a></dt>
<dd><p>write topic in YAML format</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>topic_id</strong> (<em>str</em>) – unique topic ID (default is topic ID)</p></li>
<li><p><strong>model_yaml_path</strong> (<em>str</em>) – model yaml path that has information about the dataset you use</p></li>
<li><p><strong>topic_yaml_path</strong> (<em>str</em>) – path that you use to save topic</p></li>
<li><p><strong>save</strong> (<em>bool</em>) – indicate if you want to save yaml file (True) or just show them (Fasle) (default: True)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<span class="target" id="module-Topyfic.topModel"></span><dl class="py class">
<dt class="sig sig-object py" id="Topyfic.topModel.TopModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">Topyfic.topModel.</span></span><span class="sig-name descname"><span class="pre">TopModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">topics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gene_weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gene_information</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Topyfic/topModel.html#TopModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Topyfic.topModel.TopModel" title="Permalink to this definition">¶</a></dt>
<dd><p>A class that saved a model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>str</em>) – name of class</p></li>
<li><p><strong>N</strong> (<em>int</em>) – number of topics</p></li>
<li><p><strong>gene_weights</strong> (<em>pandas dataframe</em>) – dataframe that has weights of genes for each topics; genes are indexes and topics are columns</p></li>
<li><p><strong>topics</strong> (<em>Dictionary of Topics</em>) – dictionary contains all topics for the topmodel</p></li>
<li><p><strong>model</strong> (<em>sklearn.decomposition.LatentDirichletAllocation</em>) – store reproducible LDA model</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="Topyfic.topModel.TopModel.MA_plot">
<span class="sig-name descname"><span class="pre">MA_plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">topic1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">topic2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pseudocount</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">consistency_correction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.4826</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">topN</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pdf'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'MA_plot'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Topyfic/topModel.html#TopModel.MA_plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Topyfic.topModel.TopModel.MA_plot" title="Permalink to this definition">¶</a></dt>
<dd><p>plot MA based on the gene weights on given topics</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>topic1</strong> (<em>str</em>) – first topic to be compared</p></li>
<li><p><strong>topic2</strong> (<em>str</em>) – second topic to be compared</p></li>
<li><p><strong>size</strong> (<em>pandas dataframe</em>) – table contains size of dot for each genes (genes are index)</p></li>
<li><p><strong>pseudocount</strong> (<em>float</em>) – pseudocount that you want to add (default: 1)</p></li>
<li><p><strong>threshold</strong> (<em>float</em>) – threshold to filter genes based on A values (default: 1)</p></li>
<li><p><strong>cutoff</strong> (<em>float</em>) – cutoff for categorized genes by modified z-score (default: 2)</p></li>
<li><p><strong>consistency_correction</strong> (<em>float</em>) – the factor converts the MAD to the standard deviation for a given distribution. The default value (1.4826) is the conversion factor if the underlying data is normally distributed</p></li>
<li><p><strong>topN</strong> (<em>int</em>) – number of genes to be consider for calculating z-score based on the A value (if it’s none is gonna be avarage of # genes in both topics with weights above threshold</p></li>
<li><p><strong>labels</strong> (<em>list</em>) – list of gene names wish to show in MA-plot</p></li>
<li><p><strong>save</strong> (<em>bool</em>) – indicate if you want to save the plot or not (default: True)</p></li>
<li><p><strong>show</strong> (<em>bool</em>) – indicate if you want to show the plot or not (default: True)</p></li>
<li><p><strong>file_format</strong> (<em>str</em>) – indicate the format of plot (default: pdf)</p></li>
<li><p><strong>file_name</strong> (<em>str</em>) – name and path of the plot use for save (default: MA_plot)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>return M and A values</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Topyfic.topModel.TopModel.gene_weight_rank_heatmap">
<span class="sig-name descname"><span class="pre">gene_weight_rank_heatmap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">genes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">topics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_rank</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pdf'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gene_weight_rank_heatmap'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Topyfic/topModel.html#TopModel.gene_weight_rank_heatmap"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Topyfic.topModel.TopModel.gene_weight_rank_heatmap" title="Permalink to this definition">¶</a></dt>
<dd><p>plot selected genes weights and their ranks in selected topics</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>genes</strong> (<em>list</em>) – list of genes you want to see their weights (default: all genes)</p></li>
<li><p><strong>topics</strong> (<em>list</em>) – list of topics</p></li>
<li><p><strong>show_rank</strong> (<em>bool</em>) – indicate if you want to show the rank of significant genes or not (default: True)</p></li>
<li><p><strong>scale</strong> – indicate if you want to plot as log2, log10 or not (default: None which show actual value) other options is log2 and log10</p></li>
<li><p><strong>save</strong> (<em>bool</em>) – indicate if you want to save the plot or not (default: True)</p></li>
<li><p><strong>show</strong> (<em>bool</em>) – indicate if you want to show the plot or not (default: True)</p></li>
<li><p><strong>figsize</strong> (<em>tuple of int</em>) – indicate the size of plot (default: (10 * (len(category) + 1), 10))</p></li>
<li><p><strong>file_format</strong> (<em>str</em>) – indicate the format of plot (default: pdf)</p></li>
<li><p><strong>file_name</strong> (<em>str</em>) – name and path of the plot use for save (default: gene_weight_rank_heatmap)</p></li>
</ul>
</dd>
<dt class="field-even">Scale scale</dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Topyfic.topModel.TopModel.get_feature_name">
<span class="sig-name descname"><span class="pre">get_feature_name</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/Topyfic/topModel.html#TopModel.get_feature_name"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Topyfic.topModel.TopModel.get_feature_name" title="Permalink to this definition">¶</a></dt>
<dd><p>get feature(gene) name</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>list of feature(gene) name</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Topyfic.topModel.TopModel.get_gene_weights">
<span class="sig-name descname"><span class="pre">get_gene_weights</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/Topyfic/topModel.html#TopModel.get_gene_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Topyfic.topModel.TopModel.get_gene_weights" title="Permalink to this definition">¶</a></dt>
<dd><p>get feature(gene) weights</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>dataframe contains feature(gene) weights; genes are indexes and topics are columns</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>pandas dataframe</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Topyfic.topModel.TopModel.get_ranked_gene_weight">
<span class="sig-name descname"><span class="pre">get_ranked_gene_weight</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/Topyfic/topModel.html#TopModel.get_ranked_gene_weight"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Topyfic.topModel.TopModel.get_ranked_gene_weight" title="Permalink to this definition">¶</a></dt>
<dd><p>get sorted feature(gene) weights. each value is gene and weights on each topics</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>dataframe contains feature(gene) and their weights; ranks are indexes and topics are columns</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>pandas dataframe</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Topyfic.topModel.TopModel.get_top_model_attributes">
<span class="sig-name descname"><span class="pre">get_top_model_attributes</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/Topyfic/topModel.html#TopModel.get_top_model_attributes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Topyfic.topModel.TopModel.get_top_model_attributes" title="Permalink to this definition">¶</a></dt>
<dd><p>get top model attributes to be able to make sklearn.decomposition.LatentDirichletAllocation</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>three data frame which the first one is components, the second one is exp_dirichlet_component and</p>
</dd>
</dl>
<p>the last one is combining the rest of LDA attributes which put them to gather as a dataframe
:rtype: pandas dataframe, pandas dataframe, pandas dataframe</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Topyfic.topModel.TopModel.save_rLDA_model">
<span class="sig-name descname"><span class="pre">save_rLDA_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'rLDA'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Topyfic/topModel.html#TopModel.save_rLDA_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Topyfic.topModel.TopModel.save_rLDA_model" title="Permalink to this definition">¶</a></dt>
<dd><p>save Train class as a pickle file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>str</em>) – name of the pickle file (default: rLDA)</p></li>
<li><p><strong>save_path</strong> (<em>str</em>) – directory you want to use to save pickle file (default is saving near script)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Topyfic.topModel.TopModel.save_topModel">
<span class="sig-name descname"><span class="pre">save_topModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Topyfic/topModel.html#TopModel.save_topModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Topyfic.topModel.TopModel.save_topModel" title="Permalink to this definition">¶</a></dt>
<dd><p>save TopModel class as a pickle file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>str</em>) – name of the pickle file (default: topModel_TopModel.name)</p></li>
<li><p><strong>save_path</strong> (<em>str</em>) – directory you want to use to save pickle file (default is saving near script)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<span class="target" id="module-Topyfic.analysis"></span><dl class="py class">
<dt class="sig sig-object py" id="Topyfic.analysis.Analysis">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">Topyfic.analysis.</span></span><span class="sig-name descname"><span class="pre">Analysis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Top_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colors_topics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell_participation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Topyfic/analysis.html#Analysis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Topyfic.analysis.Analysis" title="Permalink to this definition">¶</a></dt>
<dd><p>A class used to investigate the topics and gene weights compositions</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Top_model</strong> (<a class="reference internal" href="#Topyfic.topModel.TopModel" title="Topyfic.topModel.TopModel"><em>TopModel</em></a>) – top model that used for analysing topics, gene weights compositions and calculate cell participation</p></li>
<li><p><strong>colors_topics</strong> (<em>pandas dataframe</em>) – dataframe that mapped colored to topics</p></li>
<li><p><strong>cell_participation</strong> (<em>anndata</em>) – anndata that stores cell participation along with cell information in obs</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="Topyfic.analysis.Analysis.TopicTraitRelationshipHeatmap">
<span class="sig-name descname"><span class="pre">TopicTraitRelationshipHeatmap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metaData</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">annotation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pdf'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'topic-traitRelationships'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Topyfic/analysis.html#Analysis.TopicTraitRelationshipHeatmap"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Topyfic.analysis.Analysis.TopicTraitRelationshipHeatmap" title="Permalink to this definition">¶</a></dt>
<dd><p>plot topic-trait relationship heatmap</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>metaData</strong> (<em>list</em>) – traits you would like to see the relationship with topics (must be column name of cell_participation.obs)</p></li>
<li><p><strong>annotation</strong> (<em>bool</em>) – indicate if you want to add correlation and p_values as a text in each square (default:False)</p></li>
<li><p><strong>save</strong> (<em>bool</em>) – indicate if you want to save the plot or not (default: True)</p></li>
<li><p><strong>show</strong> (<em>bool</em>) – indicate if you want to show the plot or not (default: True)</p></li>
<li><p><strong>file_format</strong> (<em>str</em>) – indicate the format of plot (default: pdf)</p></li>
<li><p><strong>file_name</strong> (<em>str</em>) – name and path of the plot use for save (default: topic-traitRelationships)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Topyfic.analysis.Analysis.average_cell_participation">
<span class="sig-name descname"><span class="pre">average_cell_participation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'blue'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pdf'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'average_cell_participation'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Topyfic/analysis.html#Analysis.average_cell_participation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Topyfic.analysis.Analysis.average_cell_participation" title="Permalink to this definition">¶</a></dt>
<dd><p>barplot showing average of cell participation in each topic</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>label</strong> (<em>dict</em>) – fill with dictionary contain mapping new name for each topics to name you want to show if you want to change default topic name</p></li>
<li><p><strong>color</strong> (<em>str</em>) – color of bar plot (default: blue)</p></li>
<li><p><strong>save</strong> (<em>bool</em>) – indicate if you want to save the plot or not (default: True)</p></li>
<li><p><strong>show</strong> (<em>bool</em>) – indicate if you want to show the plot or not (default: True)</p></li>
<li><p><strong>figsize</strong> (<em>tuple of int</em>) – indicate the size of plot (default: (10 * (len(category) + 1), 10))</p></li>
<li><p><strong>file_format</strong> (<em>str</em>) – indicate the format of plot (default: pdf)</p></li>
<li><p><strong>file_name</strong> (<em>str</em>) – name and path of the plot use for save (default: piechart_topicAvgCell)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Topyfic.analysis.Analysis.average_cell_participation_line_plot">
<span class="sig-name descname"><span class="pre">average_cell_participation_line_plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">topic</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">category</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color_pallet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pdf'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'line_average_cell_participation'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Topyfic/analysis.html#Analysis.average_cell_participation_line_plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Topyfic.analysis.Analysis.average_cell_participation_line_plot" title="Permalink to this definition">¶</a></dt>
<dd><p>line plot showing average of cell participation in topic divided by two features of cells (i.e. cell type and time point)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>topic</strong> (<em>str</em>) – name of the topic</p></li>
<li><p><strong>color</strong> – name of the feature you want to have one line per group of that (it should be column name of cell_participation.obs)</p></li>
</ul>
</dd>
</dl>
<p>:type color:str
:type color_pallet: color of each category of color (if it None color assign randomly)
:param color_pallet: dict
:param category: name of the feature you want to have on x axis (it should be column name of cell_participation.obs)
:type category: str
:param save: indicate if you want to save the plot or not (default: True)
:type save: bool
:param show: indicate if you want to show the plot or not (default: True)
:type show: bool
:param figsize: indicate the size of plot (default: (10 * (len(category) + 1), 10))
:type figsize: tuple of int
:param file_format: indicate the format of plot (default: pdf)
:type file_format: str
:param file_name: name and path of the plot use for save (default: piechart_topicAvgCell)
:type file_name: str</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Topyfic.analysis.Analysis.calculate_cell_participation">
<span class="sig-name descname"><span class="pre">calculate_cell_participation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Topyfic/analysis.html#Analysis.calculate_cell_participation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Topyfic.analysis.Analysis.calculate_cell_participation" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate cell participation for give data</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>data</strong> (<em>anndata</em>) – processed expression data along with cells and genes/region information</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Topyfic.analysis.Analysis.cell_participation_distribution">
<span class="sig-name descname"><span class="pre">cell_participation_distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">plot_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'violin'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_topic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'blue'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pdf'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'dist_cell_participation'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Topyfic/analysis.html#Analysis.cell_participation_distribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Topyfic.analysis.Analysis.cell_participation_distribution" title="Permalink to this definition">¶</a></dt>
<dd><p>plot showing distribution of max/all topics in cell participation for each topic</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>plot_type</strong> (<em>str</em>) – type of the plot which can be “violin” or “bax”</p></li>
<li><p><strong>threshold</strong> (<em>float</em>) – indicate the threshold to filter out cells with low participation in each topics (default: 0.05)</p></li>
<li><p><strong>max_topic</strong> (<em>bool</em>) – indicate if you want to consider all topics for each cells (False) or only the topic with highest pariticipation (max topic) for each cells (True)</p></li>
<li><p><strong>label</strong> (<em>dict</em>) – fill with dictionary contain mapping new name for each topics to name you want to show if you want to change default topic name</p></li>
<li><p><strong>color</strong> (<em>str</em>) – color of bar plot (default: blue)</p></li>
<li><p><strong>save</strong> (<em>bool</em>) – indicate if you want to save the plot or not (default: True)</p></li>
<li><p><strong>show</strong> (<em>bool</em>) – indicate if you want to show the plot or not (default: True)</p></li>
<li><p><strong>figsize</strong> (<em>tuple of int</em>) – indicate the size of plot (default: (10 * (len(category) + 1), 10))</p></li>
<li><p><strong>file_format</strong> (<em>str</em>) – indicate the format of plot (default: pdf)</p></li>
<li><p><strong>file_name</strong> (<em>str</em>) – name and path of the plot use for save (default: piechart_topicAvgCell)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Topyfic.analysis.Analysis.convertDatTraits">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">convertDatTraits</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Topyfic/analysis.html#Analysis.convertDatTraits"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Topyfic.analysis.Analysis.convertDatTraits" title="Permalink to this definition">¶</a></dt>
<dd><p>get data trait module base on samples information</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>a dataframe contains information in suitable format for plotting module trait relationship heatmap</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>pandas dataframe</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Topyfic.analysis.Analysis.extract_cells">
<span class="sig-name descname"><span class="pre">extract_cells</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">level</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">category</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">top_cells</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_cell_participation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_cells</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Topyfic/analysis.html#Analysis.extract_cells"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Topyfic.analysis.Analysis.extract_cells" title="Permalink to this definition">¶</a></dt>
<dd><p>extract subset of cells and cells participation with specific criteria</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>level</strong> (<em>str</em>) – name of the column from cell_participation.obs</p></li>
<li><p><strong>category</strong> (<em>list of str</em>) – list of items you want to plot which are subsets of cell_participation.obs[level](default: all the unique items in cell_participation.obs[level])</p></li>
<li><p><strong>top_cells</strong> (<em>float</em>) – fraction of the cells you want to be considers (default: 0.05)</p></li>
<li><p><strong>min_cell_participation</strong> (<em>float</em>) – minimum cell participation each cells in each topics should have to be count (default: 0.05)</p></li>
<li><p><strong>min_cells</strong> (<em>int</em>) – minimum number of cells each topics should have to be reported (default: 50)</p></li>
<li><p><strong>file_name</strong> (<em>str</em>) – name and path of the plot use for save (default: selectedCells_top{top_cells}_{min_cell_score}min_score_{min_cells}min_cells.csv and cellParticipation_selectedCells_top{top_cells}_{min_cell_score}min_score_{min_cells}min_cells.csv)</p></li>
<li><p><strong>save</strong> (<em>bool</em>) – indicate if you want to save the data or not (default: False)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>table contains cell ID that pass threshold for each topic, table contains cell particiaption for cells that pass threshold for each topic (same order as fist table)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pandas dataframe, pandas dataframe</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Topyfic.analysis.Analysis.max_topic_cell_participation">
<span class="sig-name descname"><span class="pre">max_topic_cell_participation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'blue'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Maximum</span> <span class="pre">cell</span> <span class="pre">topic</span> <span class="pre">participation</span> <span class="pre">for</span> <span class="pre">each</span> <span class="pre">cells'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pdf'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'max_topic_cell_participation'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Topyfic/analysis.html#Analysis.max_topic_cell_participation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Topyfic.analysis.Analysis.max_topic_cell_participation" title="Permalink to this definition">¶</a></dt>
<dd><p>step plot showing maximum cell participation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cutoff</strong> (<em>float</em>) – indicate if you want to eliminate any cells with maximum participation less than this</p></li>
<li><p><strong>color</strong> (<em>str</em>) – color of bar plot (default: blue)</p></li>
<li><p><strong>title</strong> (<em>str</em>) – indicate if you want to all title into plot (default: Maximum cell topic participation for each cells)</p></li>
<li><p><strong>save</strong> (<em>bool</em>) – indicate if you want to save the plot or not (default: True)</p></li>
<li><p><strong>show</strong> (<em>bool</em>) – indicate if you want to show the plot or not (default: True)</p></li>
<li><p><strong>figsize</strong> (<em>tuple of int</em>) – indicate the size of plot (default: (10 * (len(category) + 1), 10))</p></li>
<li><p><strong>file_format</strong> (<em>str</em>) – indicate the format of plot (default: pdf)</p></li>
<li><p><strong>file_name</strong> (<em>str</em>) – name and path of the plot use for save (default: piechart_topicAvgCell)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Topyfic.analysis.Analysis.pie_structure_Chart">
<span class="sig-name descname"><span class="pre">pie_structure_Chart</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">level</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">category</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ascending</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pdf'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'piechart_topicAvgCell'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Topyfic/analysis.html#Analysis.pie_structure_Chart"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Topyfic.analysis.Analysis.pie_structure_Chart" title="Permalink to this definition">¶</a></dt>
<dd><p>plot pie charts that shows contribution of each topics to each category (i.e cell type)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>level</strong> (<em>str</em>) – name of the column from cell_participation.obs</p></li>
<li><p><strong>category</strong> (<em>list of str</em>) – list of items you want to plot pie charts which are subsets of cell_participation.obs[level](default: all the unique items in cell_participation.obs[level])</p></li>
<li><p><strong>ascending</strong> (<em>list of bool</em>) – for each pie chart on which order you want to sort your data (default is descending for all pie charts)</p></li>
<li><p><strong>n</strong> (<em>int</em>) – number of topics you want to annotate in pie charts (default: 5)</p></li>
<li><p><strong>save</strong> (<em>bool</em>) – indicate if you want to save the plot or not (default: True)</p></li>
<li><p><strong>show</strong> (<em>bool</em>) – indicate if you want to show the plot or not (default: True)</p></li>
<li><p><strong>figsize</strong> (<em>tuple of int</em>) – indicate the size of plot (default: (10 * (len(category) + 1), 10))</p></li>
<li><p><strong>file_format</strong> (<em>str</em>) – indicate the format of plot (default: pdf)</p></li>
<li><p><strong>file_name</strong> (<em>str</em>) – name and path of the plot use for save (default: piechart_topicAvgCell)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Topyfic.analysis.Analysis.plot_topic_composition">
<span class="sig-name descname"><span class="pre">plot_topic_composition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">category</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'topic'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">biotype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'biotype'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pdf'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gene_composition'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Topyfic/analysis.html#Analysis.plot_topic_composition"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Topyfic.analysis.Analysis.plot_topic_composition" title="Permalink to this definition">¶</a></dt>
<dd><p>plot gene composition dividing by gene biotype or topics</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>category</strong> (<em>str</em>) – topic name or gene biotype name you want to see gene composition for</p></li>
<li><p><strong>level</strong> (<em>str</em>) – indicate weather if you want to show it within each topic or gene biotype (options: “topic” or “gene_biotype”) (default: topic)</p></li>
<li><p><strong>biotype</strong> (<em>str</em>) – name of the column in gene_weight to look for gene_biotype (default: biotype)</p></li>
<li><p><strong>label</strong> (<em>bool</em>) – show label of each line within plot or not (default: False)</p></li>
<li><p><strong>save</strong> (<em>bool</em>) – indicate if you want to save the plot or not (default: True)</p></li>
<li><p><strong>show</strong> (<em>bool</em>) – indicate if you want to show the plot or not (default: True)</p></li>
<li><p><strong>file_format</strong> (<em>str</em>) – indicate the format of plot (default: pdf)</p></li>
<li><p><strong>file_name</strong> (<em>str</em>) – name and path of the plot use for save (default: gene_composition)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Topyfic.analysis.Analysis.save_analysis">
<span class="sig-name descname"><span class="pre">save_analysis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Topyfic/analysis.html#Analysis.save_analysis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Topyfic.analysis.Analysis.save_analysis" title="Permalink to this definition">¶</a></dt>
<dd><p>save Analysis class as a pickle file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>str</em>) – name of the pickle file (default: analysis_Analysis.top_model.name)</p></li>
<li><p><strong>save_path</strong> (<em>str</em>) – directory you want to use to save pickle file (default is saving near script)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Topyfic.analysis.Analysis.structure_plot">
<span class="sig-name descname"><span class="pre">structure_plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">level</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">category</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">topic_order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ascending</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metaData</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metaData_palette</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order_cells</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['hierarchy']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pdf'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'structure_topicAvgCell'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Topyfic/analysis.html#Analysis.structure_plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Topyfic.analysis.Analysis.structure_plot" title="Permalink to this definition">¶</a></dt>
<dd><p>plot structure which shows contribution of each topics for each cells in given categories</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>level</strong> (<em>str</em>) – name of the column from cell_participation.obs</p></li>
<li><p><strong>category</strong> (<em>list of str</em>) – list of items you want to plot which are subsets of cell_participation.obs[level](default: all the unique items in cell_participation.obs[level])</p></li>
<li><p><strong>topic_order</strong> (<em>list of str</em>) – indicate if you want to have a specific order of topics which it should be name of topics. if None, it’s gonna sort by cell participation</p></li>
<li><p><strong>ascending</strong> (<em>list of bool</em>) – for each structure plot on which order you want to sort your data (default is descending for all structure plot)</p></li>
<li><p><strong>metaData</strong> (<em>list</em>) – if you want to add annotation for each cell add column name of that information (make sure you have that inforamtion in your cell_participation.obs)</p></li>
<li><p><strong>metaData_palette</strong> (<em>dict</em>) – color palette for each metaData you add</p></li>
<li><p><strong>width</strong> (<em>list of int</em>) – width ratios of each category (default is based on the number of the cells we have in each category)</p></li>
<li><p><strong>n</strong> (<em>int</em>) – number of topics you want to sum if you used order_cell == ‘sum’ (default: 2)</p></li>
<li><p><strong>order_cells</strong> (<em>list</em>) – determine which kind of sorting options you want to use (‘sum’, ‘hierarchy’, sort by metaData); sum: sort cells by sum of top n topics; hierarchy: sort data by doing hierarchical clustring; metaData sort by metaData (default: [‘hierarchy’])</p></li>
<li><p><strong>save</strong> (<em>bool</em>) – indicate if you want to save the plot or not (default: True)</p></li>
<li><p><strong>show</strong> (<em>bool</em>) – indicate if you want to show the plot or not (default: True)</p></li>
<li><p><strong>figsize</strong> (<em>tuple of int</em>) – indicate the size of plot (default: (10 * (len(category) + 1), 10))</p></li>
<li><p><strong>file_format</strong> (<em>str</em>) – indicate the format of plot (default: pdf)</p></li>
<li><p><strong>file_name</strong> (<em>str</em>) – name and path of the plot use for save (default: piechart_topicAvgCell)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<span class="target" id="module-Topyfic.utilsMakeModel"></span><dl class="py function">
<dt class="sig sig-object py" id="Topyfic.utilsMakeModel.calculate_leiden_clustering">
<span class="sig-prename descclassname"><span class="pre">Topyfic.utilsMakeModel.</span></span><span class="sig-name descname"><span class="pre">calculate_leiden_clustering</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trains</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_top_genes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolution</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iter_harmony</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_cell_participation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pdf'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Topyfic/utilsMakeModel.html#calculate_leiden_clustering"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Topyfic.utilsMakeModel.calculate_leiden_clustering" title="Permalink to this definition">¶</a></dt>
<dd><p>Do leiden clustering w/o harmony base on number of assays you have and then remove low participation topics</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trains</strong> (<em>list of Train</em>) – list of train class</p></li>
<li><p><strong>data</strong> (<em>anndata</em>) – gene-count data with cells and genes information</p></li>
<li><p><strong>n_top_genes</strong> (<em>int</em>) – Number of highly-variable genes to keep (default: 50)</p></li>
<li><p><strong>resolution</strong> (<em>int</em>) – A parameter value controlling the coarseness of the clustering. Higher values lead to more clusters. (default: 1)</p></li>
<li><p><strong>max_iter_harmony</strong> (<em>int</em>) – number of iteration for running harmony (default: 10)</p></li>
<li><p><strong>min_cell_participation</strong> (<em>float</em>) – minimum cell participation across for each topics to keep them, when is None, it will keep topics with cell participation more than 1% of #cells (#cells / 100)</p></li>
<li><p><strong>file_format</strong> (<em>str</em>) – indicate the format of plot (default: pdf)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>final TopModel instance after clustering and trimming, dataframe containing which run goes to which topic</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#Topyfic.topModel.TopModel" title="Topyfic.topModel.TopModel">TopModel</a>, pandas dataframe</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Topyfic.utilsMakeModel.combine_topModels">
<span class="sig-prename descclassname"><span class="pre">Topyfic.utilsMakeModel.</span></span><span class="sig-name descname"><span class="pre">combine_topModels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">topModels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Combined_TopModel'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_cell_participation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Topyfic/utilsMakeModel.html#combine_topModels"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Topyfic.utilsMakeModel.combine_topModels" title="Permalink to this definition">¶</a></dt>
<dd><p>Combine two topmodels. It will not apply any method when we want to combine them, so basically just combine all models without performing any method</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>topModels</strong> (<em>list of TopModel</em>) – list of topmodels you want to combine</p></li>
<li><p><strong>name</strong> (<em>str</em>) – name of the combined topmodels</p></li>
<li><p><strong>data</strong> (<em>anndata</em>) – if you want to remove topics with low cell participation, you can pass the data you used to train models</p></li>
<li><p><strong>min_cell_participation</strong> (<em>float</em>) – minimum cell participation across for each topics to keep them, when is None, it will keep topics with cell participation more than 1% of #cells (#cells / 100)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>return the combined TopModel, number of topics, gene weights</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#Topyfic.topModel.TopModel" title="Topyfic.topModel.TopModel">TopModel</a>, int, pandas DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Topyfic.utilsMakeModel.filter_LDA_model">
<span class="sig-prename descclassname"><span class="pre">Topyfic.utilsMakeModel.</span></span><span class="sig-name descname"><span class="pre">filter_LDA_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">main_lda</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Topyfic/utilsMakeModel.html#filter_LDA_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Topyfic.utilsMakeModel.filter_LDA_model" title="Permalink to this definition">¶</a></dt>
<dd><p>filter LDA based on the topics we want to keep</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>main_lda</strong> (<em>sklearn.decomposition.LatentDirichletAllocation</em>) – Latent Dirichlet Allocation with online variational Bayes algorithm.</p></li>
<li><p><strong>keep</strong> (<em>pandas dataframe</em>) – dataframe that define which topics we want to keep</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Latent Dirichlet Allocation with online variational Bayes algorithm, weights of genes in each topics (indexes are topics and columns are genes)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>sklearn.decomposition.LatentDirichletAllocation, pandas dataframe</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Topyfic.utilsMakeModel.initialize_lda_model">
<span class="sig-prename descclassname"><span class="pre">Topyfic.utilsMakeModel.</span></span><span class="sig-name descname"><span class="pre">initialize_lda_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">components</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exp_dirichlet_component</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">others</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Topyfic/utilsMakeModel.html#initialize_lda_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Topyfic.utilsMakeModel.initialize_lda_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize LDA model by passing all necessary attributes</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>components</strong> (<em>pandas dataframe</em>) – Variational parameters for topic gene distribution</p></li>
<li><p><strong>exp_dirichlet_component</strong> (<em>pandas dataframe</em>) – Exponential value of expectation of log topic gene distribution</p></li>
<li><p><strong>others</strong> (<em>pandas dataframe</em>) – dataframe contains remaining necessary attributes including: n_batch_iter: Number of iterations of the EM step. n_features_in: Number of features seen during fit. n_iter: Number of passes over the dataset. bound: Final perplexity score on training set. doc_topic_prior: Prior of document topic distribution theta. If the value is None, it is 1 / n_components. topic_word_prior: Prior of topic word distribution beta. If the value is None, it is 1 / n_components.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Latent Dirichlet Allocation with online variational Bayes algorithm.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>sklearn.decomposition.LatentDirichletAllocation</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Topyfic.utilsMakeModel.initialize_rLDA_model">
<span class="sig-prename descclassname"><span class="pre">Topyfic.utilsMakeModel.</span></span><span class="sig-name descname"><span class="pre">initialize_rLDA_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">all_components</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_exp_dirichlet_component</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_others</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clusters</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Topyfic/utilsMakeModel.html#initialize_rLDA_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Topyfic.utilsMakeModel.initialize_rLDA_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize reproducible LDA model by calculating all necessary attributes using clustering.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>all_components</strong> (<em>pandas dataframe</em>) – Variational parameters for topic gene distribution from all single LDA models</p></li>
<li><p><strong>all_exp_dirichlet_component</strong> (<em>pandas dataframe</em>) – Exponential value of expectation of log topic gene distribution from all single LDA models</p></li>
<li><p><strong>all_others</strong> (<em>pandas dataframe</em>) – dataframe contains remaining necessary attributes including: n_batch_iter: Number of iterations of the EM step. n_features_in: Number of features seen during fit. n_iter: Number of passes over the dataset. bound: Final perplexity score on training set. doc_topic_prior: Prior of document topic distribution theta. If the value is None, it is 1 / n_components. topic_word_prior: Prior of topic word distribution beta. If the value is None, it is 1 / n_components.</p></li>
<li><p><strong>clusters</strong> (<em>pandas dataframe</em>) – dataframe that mapped each LDA run to each clusters</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Latent Dirichlet Allocation with online variational Bayes algorithm.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>sklearn.decomposition.LatentDirichletAllocation</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Topyfic.utilsMakeModel.make_analysis_class">
<span class="sig-prename descclassname"><span class="pre">Topyfic.utilsMakeModel.</span></span><span class="sig-name descname"><span class="pre">make_analysis_class</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">top_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colors_topics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Topyfic/utilsMakeModel.html#make_analysis_class"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Topyfic.utilsMakeModel.make_analysis_class" title="Permalink to this definition">¶</a></dt>
<dd><p>Creating Analysis object</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>top_model</strong> (<a class="reference internal" href="#Topyfic.topModel.TopModel" title="Topyfic.topModel.TopModel"><em>TopModel</em></a>) – top model that used for analysing topics, gene weights compositions and calculate cell participation</p></li>
<li><p><strong>data</strong> (<em>anndata</em>) – processed expression data along with cells and genes/region information</p></li>
<li><p><strong>colors_topics</strong> (<em>pandas dataframe</em>) – dataframe that mapped colored to topics</p></li>
<li><p><strong>save_path</strong> (<em>str</em>) – directory you want to use to save pickle file (default is saving near script)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Topyfic.utilsMakeModel.make_topModel">
<span class="sig-prename descclassname"><span class="pre">Topyfic.utilsMakeModel.</span></span><span class="sig-name descname"><span class="pre">make_topModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trains</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_top_genes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolution</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pdf'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Topyfic/utilsMakeModel.html#make_topModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Topyfic.utilsMakeModel.make_topModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Creating topModel base on train data and save it along with clustering information</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trains</strong> (<em>list of Train</em>) – list of train class</p></li>
<li><p><strong>data</strong> (<em>anndata</em>) – expression data embedded in anndata format along with cells and genes/region information</p></li>
<li><p><strong>n_top_genes</strong> (<em>int</em>) – Number of highly-variable genes to keep (default: 50)</p></li>
<li><p><strong>resolution</strong> (<em>int</em>) – A parameter value controlling the coarseness of the clustering. Higher values lead to more clusters. (default: 1)</p></li>
<li><p><strong>file_format</strong> (<em>str</em>) – indicate the format of plot (default: pdf)</p></li>
<li><p><strong>save_path</strong> (<em>str</em>) – directory you want to use to save pickle file (default is saving near script)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Topyfic.utilsMakeModel.plot_cluster_contribution">
<span class="sig-prename descclassname"><span class="pre">Topyfic.utilsMakeModel.</span></span><span class="sig-name descname"><span class="pre">plot_cluster_contribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">clustering</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_all</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">portion</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pdf'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cluster_contribution'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Topyfic/utilsMakeModel.html#plot_cluster_contribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Topyfic.utilsMakeModel.plot_cluster_contribution" title="Permalink to this definition">¶</a></dt>
<dd><p>barplot shows number of topics contribute to each cluster</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>clustering</strong> (<em>pandas dataframe</em>) – dataframe that map each single LDA run to each cluster</p></li>
<li><p><strong>feature</strong> (<em>str</em>) – name of the feature you want to see the cluster contribution (should be one of the columns name of clustering df)</p></li>
<li><p><strong>show_all</strong> (<em>bool</em>) – Indicate if you want to show all clusters or only the ones that pass threshold (default: False)</p></li>
<li><p><strong>portion</strong> (<em>bool</em>) – Indicate if you want to normalized the bar to show percentage instead of actual value (default: True)</p></li>
<li><p><strong>save</strong> (<em>bool</em>) – indicate if you want to save the plot or not (default: True)</p></li>
<li><p><strong>show</strong> (<em>bool</em>) – indicate if you want to show the plot or not (default: True)</p></li>
<li><p><strong>file_format</strong> (<em>str</em>) – indicate the format of plot (default: pdf)</p></li>
<li><p><strong>file_name</strong> (<em>str</em>) – name and path of the plot use for save (default: cluster_contribution)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Topyfic.utilsMakeModel.read_analysis">
<span class="sig-prename descclassname"><span class="pre">Topyfic.utilsMakeModel.</span></span><span class="sig-name descname"><span class="pre">read_analysis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Topyfic/utilsMakeModel.html#read_analysis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Topyfic.utilsMakeModel.read_analysis" title="Permalink to this definition">¶</a></dt>
<dd><p>reading analysis pickle file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>file</strong> (<em>str</em>) – path of the pickle file</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>analysis instance</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Analysis class</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Topyfic.utilsMakeModel.read_model_yaml">
<span class="sig-prename descclassname"><span class="pre">Topyfic.utilsMakeModel.</span></span><span class="sig-name descname"><span class="pre">read_model_yaml</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_yaml_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'model.yaml'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">topic_yaml_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell_topic_participation_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Topyfic/utilsMakeModel.html#read_model_yaml"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Topyfic.utilsMakeModel.read_model_yaml" title="Permalink to this definition">¶</a></dt>
<dd><p>read YMAL files and make topmodel object
write topic in YAML format</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_yaml_path</strong> (<em>str</em>) – model yaml path</p></li>
<li><p><strong>topic_yaml_path</strong> (<em>str</em>) – path that you use to save all topics information</p></li>
<li><p><strong>cell_topic_participation_path</strong> (<em>str</em>) – path of cell-topic participation</p></li>
<li><p><strong>save</strong> (<em>bool</em>) – indicate if you want to save objects (topmodel and analysis) as a pickle file (default: True)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Topmodel and analysis objects</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#Topyfic.topModel.TopModel" title="Topyfic.topModel.TopModel">TopModel</a>, <a class="reference internal" href="#Topyfic.analysis.Analysis" title="Topyfic.analysis.Analysis">Analysis</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Topyfic.utilsMakeModel.read_topModel">
<span class="sig-prename descclassname"><span class="pre">Topyfic.utilsMakeModel.</span></span><span class="sig-name descname"><span class="pre">read_topModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Topyfic/utilsMakeModel.html#read_topModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Topyfic.utilsMakeModel.read_topModel" title="Permalink to this definition">¶</a></dt>
<dd><p>reading topModel pickle file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>file</strong> (<em>str</em>) – path of the pickle file</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>topModel instance</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>TopModel class</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Topyfic.utilsMakeModel.read_train">
<span class="sig-prename descclassname"><span class="pre">Topyfic.utilsMakeModel.</span></span><span class="sig-name descname"><span class="pre">read_train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Topyfic/utilsMakeModel.html#read_train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Topyfic.utilsMakeModel.read_train" title="Permalink to this definition">¶</a></dt>
<dd><p>reading train pickle file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>file</strong> (<em>str</em>) – path of the pickle file</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>train instance</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Train class</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Topyfic.utilsMakeModel.subset_data">
<span class="sig-prename descclassname"><span class="pre">Topyfic.utilsMakeModel.</span></span><span class="sig-name descname"><span class="pre">subset_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'var'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Topyfic/utilsMakeModel.html#subset_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Topyfic.utilsMakeModel.subset_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Subsetting data</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>anndata</em>) – data we want to subset</p></li>
<li><p><strong>keep</strong> (<em>list</em>) – values in the obs/var_names</p></li>
<li><p><strong>loc</strong> – subsetting in which direction (default: ‘var’)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>data we want to keep</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>anndata</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Topyfic.utilsMakeModel.train_model">
<span class="sig-prename descclassname"><span class="pre">Topyfic.utilsMakeModel.</span></span><span class="sig-name descname"><span class="pre">train_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_runs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_thread</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Topyfic/utilsMakeModel.html#train_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Topyfic.utilsMakeModel.train_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Training model and save it</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>str</em>) – name of the Train class</p></li>
<li><p><strong>k</strong> (<em>int</em>) – number of topics to learn one LDA model using sklearn package (default: 50)</p></li>
<li><p><strong>n_runs</strong> (<em>int</em>) – number of run to define rLDA model (default: 100)</p></li>
<li><p><strong>random_state_range</strong> (<em>list of int</em>) – list of random state, we used to run LDA models (default: range(n_runs))</p></li>
<li><p><strong>data</strong> (<em>anndata</em>) – data embedded in anndata format use to train LDA model</p></li>
<li><p><strong>n_thread</strong> (<em>int</em>) – number of threads you used to learn LDA models (default=5)</p></li>
<li><p><strong>save_path</strong> (<em>str</em>) – directory you want to use to save pickle file (default is saving near script)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<span class="target" id="module-Topyfic.utilsAnalyseModel"></span><dl class="py function">
<dt class="sig sig-object py" id="Topyfic.utilsAnalyseModel.GSEA">
<span class="sig-prename descclassname"><span class="pre">Topyfic.utilsAnalyseModel.</span></span><span class="sig-name descname"><span class="pre">GSEA</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gene_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gene_sets</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'GO_Biological_Process_2021'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pdf'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'GSEA'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Topyfic/utilsAnalyseModel.html#GSEA"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Topyfic.utilsAnalyseModel.GSEA" title="Permalink to this definition">¶</a></dt>
<dd><p>Doing Gene Set Enrichment Analysis on based on the topic weights using GSEAPY package.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gene_list</strong> (<em>pandas series</em>) – pandas series with index as a gene names and their ranks/weights as value</p></li>
<li><p><strong>gene_sets</strong> (<em>str</em><em>, </em><em>list</em><em>, </em><em>tuple</em>) – Enrichr Library name or .gmt gene sets file or dict of gene sets. (you can add any Enrichr Libraries from here: <a class="reference external" href="https://maayanlab.cloud/Enrichr/#stats">https://maayanlab.cloud/Enrichr/#stats</a>)</p></li>
<li><p><strong>p_value</strong> (<em>float</em>) – Defines the pValue threshold for plotting. (default: 0.05)</p></li>
<li><p><strong>table</strong> (<em>bool</em>) – indicate if you want to save all GO terms that passed the threshold as a table (default: True)</p></li>
<li><p><strong>plot</strong> (<em>bool</em>) – indicate if you want to plot all GO terms that passed the threshold (default: True)</p></li>
<li><p><strong>file_format</strong> (<em>str</em>) – indicate the format of plot (default: pdf)</p></li>
<li><p><strong>file_name</strong> (<em>str</em>) – name and path of the plot use for save (default: gene_composition)</p></li>
<li><p><strong>kwargs</strong> – Argument to pass to gseapy.prerank(). more info: <a class="reference external" href="https://gseapy.readthedocs.io/en/latest/run.html?highlight=gp.prerank#gseapy.prerank">https://gseapy.readthedocs.io/en/latest/run.html?highlight=gp.prerank#gseapy.prerank</a></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>dataframe contains these columns: Term: gene set name, ES: enrichment score, NES: normalized enrichment score, NOM p-val:  Nominal p-value (from the null distribution of the gene set, FDR q-val: FDR qvalue (adjusted False Discory Rate), FWER p-val: Family wise error rate p-values, Tag %: Percent of gene set before running enrichment peak (ES), Gene %: Percent of gene list before running enrichment peak (ES), Lead_genes: leading edge genes (gene hits before running enrichment peak)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pandas dataframe</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Topyfic.utilsAnalyseModel.MA_plot">
<span class="sig-prename descclassname"><span class="pre">Topyfic.utilsAnalyseModel.</span></span><span class="sig-name descname"><span class="pre">MA_plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">topic1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">topic2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pseudocount</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">consistency_correction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.4826</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">topN</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pdf'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'MA_plot'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Topyfic/utilsAnalyseModel.html#MA_plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Topyfic.utilsAnalyseModel.MA_plot" title="Permalink to this definition">¶</a></dt>
<dd><p>plot MA based on the gene weights on given topics</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>topic1</strong> (<em>pandas.series</em>) – gene weight of first topic to be compared</p></li>
<li><p><strong>topic2</strong> (<em>pandas.series</em>) – gene weight of second topic to be compared</p></li>
<li><p><strong>size</strong> (<em>pandas dataframe</em>) – table contains size of dot for each genes (genes are index)</p></li>
<li><p><strong>pseudocount</strong> (<em>float</em>) – pseudocount that you want to add (default: 1)</p></li>
<li><p><strong>threshold</strong> (<em>float</em>) – threshold to filter genes based on A values (default: 1)</p></li>
<li><p><strong>cutoff</strong> (<em>float</em>) – cutoff for categorized genes by modified z-score (default: 2)</p></li>
<li><p><strong>consistency_correction</strong> (<em>float</em>) – the factor converts the MAD to the standard deviation for a given distribution. The default value (1.4826) is the conversion factor if the underlying data is normally distributed</p></li>
<li><p><strong>topN</strong> (<em>int</em>) – number of genes to be consider for calculating z-score based on the A value (if it’s none is gonna be avarage of # genes in both topics with weights above threshold</p></li>
<li><p><strong>labels</strong> (<em>list</em>) – list of gene names wish to show in MA-plot</p></li>
<li><p><strong>save</strong> (<em>bool</em>) – indicate if you want to save the plot or not (default: True)</p></li>
<li><p><strong>show</strong> (<em>bool</em>) – indicate if you want to show the plot or not (default: True)</p></li>
<li><p><strong>file_format</strong> (<em>str</em>) – indicate the format of plot (default: pdf)</p></li>
<li><p><strong>file_name</strong> (<em>str</em>) – name and path of the plot use for save (default: MA_plot)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>return M and A values</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Topyfic.utilsAnalyseModel.compare_topModels">
<span class="sig-prename descclassname"><span class="pre">Topyfic.utilsAnalyseModel.</span></span><span class="sig-name descname"><span class="pre">compare_topModels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">topModels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comparison_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Jensen–Shannon</span> <span class="pre">divergence'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'graph'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">topModels_color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">topModels_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_genes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pdf'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'compare_topics'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Topyfic/utilsAnalyseModel.html#compare_topModels"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Topyfic.utilsAnalyseModel.compare_topModels" title="Permalink to this definition">¶</a></dt>
<dd><p>compare topModels using topic gene weights</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>topModels</strong> (<em>list of TopModel class</em>) – list of topModel class you want to compare to each other</p></li>
<li><p><strong>comparison_method</strong> (<em>str</em>) – indicate the method you want to use for comparing topics. if you used Jensen–Shannon, we show -log2 (options: pearson correlation, spearman correlation, Jensen–Shannon divergence)</p></li>
<li><p><strong>output_type</strong> (<em>str</em>) – indicate the type of output you want. graph: plot as a graph, heatmap: plot as a heatmap, table: table contains correlation. Note: if you want to plot Jensen–Shannon divergence as a graph, we convert the values to be at the -log2(), so you need to take that account for defining threshold</p></li>
<li><p><strong>threshold</strong> (<em>float</em>) – only apply when you choose circular which only show correlation above that</p></li>
<li><p><strong>topModels_color</strong> (<em>dict</em>) – dictionary of colors mapping each topics to each color (default: blue)</p></li>
<li><p><strong>topModels_label</strong> (<em>dict</em>) – dictionary of label mapping each topics to each label</p></li>
<li><p><strong>ignore_genes</strong> (<em>bool</em>) – idicate how to behave to the genes that only represent in one the topics. “True” means it’s gonna ignore those genes and “False” means it’s gonna asumne the weights are zero for those genes that we don’t have any weights in one of the mouse models</p></li>
<li><p><strong>save</strong> (<em>bool</em>) – indicate if you want to save the plot or not (default: True)</p></li>
<li><p><strong>plot_show</strong> (<em>bool</em>) – indicate if you want to show the plot or not (default: True)</p></li>
<li><p><strong>figsize</strong> (<em>tuple of int</em>) – indicate the size of plot (default: (10 * (len(category) + 1), 10))</p></li>
<li><p><strong>plot_format</strong> (<em>str</em>) – indicate the format of plot (default: pdf)</p></li>
<li><p><strong>file_name</strong> (<em>str</em>) – name and path of the plot use for save (default: compare_topics)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>table contains correlation between topics only when table is choose and save is False</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pandas dataframe</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Topyfic.utilsAnalyseModel.functional_enrichment_analysis">
<span class="sig-prename descclassname"><span class="pre">Topyfic.utilsAnalyseModel.</span></span><span class="sig-name descname"><span class="pre">functional_enrichment_analysis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gene_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">organism</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sets</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pdf'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'functional_enrichment_analysis'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Topyfic/utilsAnalyseModel.html#functional_enrichment_analysis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Topyfic.utilsAnalyseModel.functional_enrichment_analysis" title="Permalink to this definition">¶</a></dt>
<dd><p>Doing functional enrichment analysis including GO, KEGG and REACTOME</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>gene_list</strong> – list of gene name</p>
</dd>
</dl>
<p>:type gene_list:list
:param type: indicate the type of databases which it should be one of “GO”, “REACTOME”
:type type: str
:param organism: name of the organ you want to do functional enrichment analysis
:type organism: str
:param sets: str, list, tuple of Enrichr Library name(s). (you can add any Enrichr Libraries from here: <a class="reference external" href="https://maayanlab.cloud/Enrichr/#stats">https://maayanlab.cloud/Enrichr/#stats</a>) only need to fill if the type is GO
:type sets: str, list, tuple
:param p_value: Defines the pValue threshold. (default: 0.05)
:type p_value: float
:param file_format: indicate the format of plot (default: pdf)
:type file_format: str
:param file_name: name and path of the plot use for save (default: gene_composition)
:type file_name: str</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Topyfic.utilsAnalyseModel.modified_zscore">
<span class="sig-prename descclassname"><span class="pre">Topyfic.utilsAnalyseModel.</span></span><span class="sig-name descname"><span class="pre">modified_zscore</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">consistency_correction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.4826</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Topyfic/utilsAnalyseModel.html#modified_zscore"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Topyfic.utilsAnalyseModel.modified_zscore" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the modified z score and Median Absolute Deviation (MAD) from the scores in data.
The consistency_correction factor converts the MAD to the standard deviation for a given
distribution. The default value (1.4826) is the conversion factor if the underlying data
is normally distributed</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Topyfic.utilsAnalyseModel.summarize_GO_Term">
<span class="sig-prename descclassname"><span class="pre">Topyfic.utilsAnalyseModel.</span></span><span class="sig-name descname"><span class="pre">summarize_GO_Term</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">GO_terms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'html'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'GO_sum'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Topyfic/utilsAnalyseModel.html#summarize_GO_Term"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Topyfic.utilsAnalyseModel.summarize_GO_Term" title="Permalink to this definition">¶</a></dt>
<dd><p>Summarize long, unintelligible lists of GO terms by finding a representative subset of the terms showing more unique (child) Go terms
We suggest save it as html since it’s gonna be plot by plotly so you can take an advantage of using plotly</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>GO_terms</strong> (<em>pandas dataframe</em>) – Dataframe contains results of gene ontology analysis performs by GSEAPY (<a class="reference external" href="https://gseapy.readthedocs.io/en/latest/index.html">https://gseapy.readthedocs.io/en/latest/index.html</a>)</p></li>
<li><p><strong>p_value</strong> (<em>float</em>) – Defines the pValue threshold for plotting. (default: 0.05)</p></li>
<li><p><strong>file_format</strong> (<em>str</em>) – indicate the format of plot (default: html)</p></li>
<li><p><strong>file_name</strong> (<em>str</em>) – name and path of the plot use for save (default: gene_composition)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>dataframe used to plot the results</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pandas dataframe</p>
</dd>
</dl>
</dd></dl>

</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2022, Narges Rezaie.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 5.0.2.<br/>
    </p>
  </div>
</footer>
  </body>
</html>